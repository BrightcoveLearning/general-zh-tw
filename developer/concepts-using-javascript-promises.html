---
title: '使用 JavaScript 承諾'
parent: Developers 
---

<article class="bcls-article">
  <h1>概念：使用JavaScript承諾</h1>
  <summary>在本主題中，您將學習如何使用由某些Brightcove Player方法返回的JavaScript Promises。</summary>
  <section class="bcls-section">
    <h2 id="section-name2">簡單的承諾</h2>
    <!-- <aside class="bcls-aside bcls-aside--information">Note: <strong translate="No">Promises</strong> do not work in IE11. Use the polyfill of the <a translate="No" href="https://www.npmjs.com/package/es6-promise">ES6-Promise</a> to add this functionality to IE11.</aside> -->
    <p>儘管本文檔的目的不是教您如何編寫JavaScript <code translate="No">Promise</code>，了解如何使用它們，看看如何簡單是很有啟發性的<code translate="No">Promise</code>被編碼。</p>
    <p>在下面，<code translate="No">Promise</code>將創建一個返回的字符串，該字符串指出任務是否已完成。關鍵是<code translate="No">Promise.resolve()</code>或者<code translate="No">Promise.reject()</code>方法被調用。在這種情況下，兩個方法都傳遞了一個簡單的字符串，但這可能是一個對象。</p>
    <aside class="bcls-aside bcls-aside--information">筆記：儘管在此簡單示例中未進行演示，但是<code translate="No">Promise</code>對象代表<strong>最終完成</strong>（或失敗）的<strong>異步操作</strong>，其結果值。這樣一個<code translate="No">Promise</code>在概念上類似於回調函數。</aside>
    <pre class="line-numbers">
          <code class="language-javascript" translate="No">let promiseToFinishTask = new Promise(function(resolve, reject) {
          
            //Business logic to set taskComplete boolean
            let taskComplete = true;
          
            if (taskComplete) {
              resolve('Yea, I am done');
            } else {
              reject('Not quite done');
            }
          });</code></pre>
    <p>現在您將看到如何處理退貨<code translate="No">Promise</code>信息，這是您對某些Brightcove Player API方法調用所做的操作。基本的處理如下：</p>
    如下：
    <pre class="line-numbers">
          <code class="language-javascript" translate="No">promiseName.then(
            // Function call for promise resolved
          ).catch(
            // Function call for promise rejected
          )</code></pre>
    <p>處理上面的簡單示例如下所示：</p>
    <pre class="line-numbers">
          <code class="language-javascript" translate="No">promiseToFinishTask.then(function(fromResolve) {
            console.log(fromResolve);
          }).catch(function(fromReject) {
            console.log(fromReject);
          });</code></pre>
    <p>如果<code translate="No">Promise</code>解決了<code translate="No">then</code>代碼已執行，如果<code translate="No">Promise</code>被拒絕了<code translate="No">catch</code>代碼被執行。例如，字符串之一<strong translate="No">是的，我完成了</strong>或者<strong translate="No">沒有完成</strong>將根據設置的業務邏輯出現<code translate="No">taskComplete</code>變量的值。</p>
  </section>
  <section class="bcls-section">
    <h2 id="section-name3">Brightcove的例子</h2>
    <p>Brightcove玩家的<code translate="No">play()</code>方法可能會返回一個Promise，可用於檢查播放器是否可以自動播放播放器中當前的視頻。處理<code translate="No">Promise</code>突出顯示：</p>
    <pre class="line-numbers">
          <code class="language-javascript" translate="No">var myPlayer = videojs.getPlayer('myPlayerID');
          myPlayer.on('loadedmetadata',function() {
            var promise = myPlayer.play();
            if (promise !== undefined) {
              <span class="bcls-highlight">promise.then(function() {
                // Autoplay started!
              }).catch(function(error) {
                // Autoplay was prevented.
              });</span>
            }
          });</code></pre>
    <p>基於此，您可以然後編碼是否自動播放視頻的行為。有關使用視頻播放音頻的特定用例，請參見<a href="https://player.support.brightcove.com/playback/autoplay-considerations.html#Specific_use_case">具體用例</a>的部分<strong>自動播放注意事項</strong>文檔。</p>
    <p>有關JavaScript承諾的完整信息，請參見<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">MDN承諾</a>文檔。</p>
  </section>
  <section class="bcls-section">
    <h2 id="Promise_versus_callback"><code translate="No">Promise</code>與回調</h2>
    <p>在本節中，目錄的<code translate="No">get()</code>方法用於演示使用<code translate="No">Promise</code>而不是回調函數。這<code translate="No">get()</code>方法可以與任何一種方法一起使用。</p>
    <h3>無極語法</h3>
    <p>以下代碼段顯示了對的調用<code translate="No">get()</code>方法，將響應作為<code translate="No">Promise</code>：</p>
    <pre class="line-numbers">
          <code class="language-javascript" translate="No">myPlayer.catalog.get(catalogParams).then(function(videosReturned){
            console.log('videosReturned',videosReturned);
            myPlayer.playlist(videosReturned);
          }).catch(function(errorObj){
            console.log('errorObj',errorObj);
          })</code></pre>
    <h3>回調函數語法</h3>
    <p>以下代碼段顯示了對的調用<code translate="No">get()</code>方法，使用回調函數處理響應：</p>
    <pre class="line-numbers">
            <code class="language-javascript" translate="No">myPlayer.catalog.get(catalogParams,function(errorObj,videosReturned){
            console.log('errorObj',errorObj);
            console.log('videosReturned',videosReturned);
            myPlayer.playlist(videosReturned);
          });
          </code></pre>
  </section>
</article>